"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8838],{8838:(S,u,c)=>{c.r(u),c.d(u,{OrderPageModule:()=>M});var d=c(9808),p=c(2382),o=c(8161),g=c(6115),m=c(655),t=c(5e3),h=c(9792),_=c(1135);let f=(()=>{class n{constructor(){this.cart=[],this.cartObservable=new _.X([]),this.loadCart()}loadCart(){const e=localStorage.getItem("cart");e&&(this.cart=JSON.parse(e),this.cartObservable.next(this.cart))}saveCart(){localStorage.setItem("cart",JSON.stringify(this.cart))}getCart(){return this.cart}getCartObservable(){return this.cartObservable.asObservable()}getTotal(){return this.cart.reduce((e,r)=>e+r.price*r.quantity,0)}getTotalItems(){return this.cart.reduce((e,r)=>e+r.quantity,0)}addProduct(e){const r=this.cart.find(i=>i.id===e.id);r?r.quantity+=e.quantity:this.cart.push(e),this.saveCart(),this.cartObservable.next(this.cart)}decreaseProduct(e){const r=this.cart.findIndex(i=>i.id===e.id);r>-1&&(this.cart[r].quantity>1?this.cart[r].quantity--:this.cart.splice(r,1),this.saveCart(),this.cartObservable.next(this.cart))}removeProduct(e){const r=this.cart.findIndex(i=>i.id===e.id);r>-1&&(this.cart.splice(r,1),this.saveCart(),this.cartObservable.next(this.cart))}clearCart(){this.cart=[],this.saveCart(),this.cartObservable.next(this.cart)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function O(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"ion-card",27)(1,"ion-item",28)(2,"ion-thumbnail",1),t._UZ(3,"img",29),t.qZA(),t.TgZ(4,"ion-label",30)(5,"h2"),t._uU(6),t.qZA(),t.TgZ(7,"p",31),t._uU(8),t.qZA(),t.TgZ(9,"p",32),t._uU(10),t.ALo(11,"number"),t.qZA(),t.TgZ(12,"p",33),t._uU(13),t.qZA()()(),t.TgZ(14,"ion-card-content")(15,"div",34)(16,"ion-button",35),t.NdJ("click",function(){const s=t.CHM(e).index;return t.oxw(2).remove(s)}),t._UZ(17,"ion-icon",36),t.qZA(),t.TgZ(18,"span",37),t._uU(19),t.qZA(),t.TgZ(20,"ion-button",35),t.NdJ("click",function(){const s=t.CHM(e).index;return t.oxw(2).add(s)}),t._UZ(21,"ion-icon",38),t.qZA(),t.TgZ(22,"ion-button",39),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).deleteItem(s.prodID)}),t._UZ(23,"ion-icon",40),t.qZA()(),t.TgZ(24,"p",41),t._uU(25),t.ALo(26,"number"),t.qZA()()()}if(2&n){const e=a.$implicit;t.xp6(3),t.s9C("alt",e.title),t.Q6J("src",e.image,t.LSH),t.xp6(3),t.Oqu(e.title),t.xp6(2),t.hij("ID: ",e.prodID,""),t.xp6(2),t.hij("R",t.xi3(11,10,e.amount,"1.2-2"),""),t.xp6(2),t.Q6J("ngClass","CONFIRMED"===e.status?"confirmed":"pending"),t.xp6(1),t.hij(" ",e.status," "),t.xp6(6),t.Oqu(e.qty),t.xp6(6),t.AsE(" Price: R",t.xi3(26,13,e.amount,"1.2-2")," \u2022 Left: ",e.qtyLeft," ")}}function x(n,a){if(1&n&&(t.TgZ(0,"ion-list"),t.YNc(1,O,27,16,"ion-card",26),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.orders)}}function C(n,a){1&n&&(t.TgZ(0,"div",42),t._UZ(1,"ion-icon",43),t.TgZ(2,"p"),t._uU(3,"No orders to display."),t.qZA()())}function b(n,a){if(1&n&&(t.TgZ(0,"div",48),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.lnq(" ",e.name," \u2014 Qty: ",e.quantity," \u2014 R",t.xi3(2,3,e.price*e.quantity,"1.2-2")," ")}}function v(n,a){if(1&n&&(t.TgZ(0,"div",44)(1,"h3"),t._uU(2,"Order Summary"),t.qZA(),t.TgZ(3,"div",45),t.YNc(4,b,3,6,"div",46),t.qZA(),t.TgZ(5,"div",47)(6,"span"),t._uU(7,"Sub Total:"),t.qZA(),t.TgZ(8,"span"),t._uU(9),t.ALo(10,"number"),t.qZA()(),t.TgZ(11,"div",47)(12,"span"),t._uU(13,"VAT Included:"),t.qZA(),t.TgZ(14,"span"),t._uU(15),t.ALo(16,"number"),t.qZA()(),t.TgZ(17,"div",47)(18,"span"),t._uU(19,"Delivery:"),t.qZA(),t.TgZ(20,"span"),t._uU(21,"Free"),t.qZA()()()),2&n){const e=t.oxw();t.xp6(4),t.Q6J("ngForOf",e.orderSummary),t.xp6(5),t.hij("R",t.xi3(10,3,e.total_amt,"1.2-2"),""),t.xp6(6),t.hij("R",t.xi3(16,6,15*e.total_amt/115,"1.2-2"),"")}}function y(n,a){1&n&&(t.TgZ(0,"div",49)(1,"h3"),t._uU(2,"Order Summary"),t.qZA(),t.TgZ(3,"p"),t._uU(4,"No items selected."),t.qZA()())}const P=[{path:"",component:(()=>{class n{constructor(e,r,i,s,l,T,q){this.loadingController=e,this.modalCtrl=r,this.alertCtrl=i,this.cdr=s,this.router=l,this.fireService=T,this.cartService=q,this.amount=0,this.orders=[],this.total_amt=0,this.totalItems=0,this.notifications=0,this.orderSummary=[]}ngOnInit(){this.cartService.clearCart(),this.total_amt=0,this.totalItems=0,this.orderSummary=[],this.presentLoading().then(()=>{this.fireService.getProducts().subscribe(e=>{this.orders=e.map(r=>{var i,s;return Object.assign(Object.assign({},r),{qty:0,qtyLeft:null!==(s=null!==(i=r.qtyLeft)&&void 0!==i?i:r.stock)&&void 0!==s?s:r.qty})}),this.loadingController.dismiss(),this.cdr.detectChanges()})}),this.cartSub=this.cartService.getCartObservable().subscribe(()=>{this.totalItems=this.cartService.getTotalItems(),this.total_amt=this.cartService.getTotal(),this.updateOrderSummary(),this.cdr.detectChanges()})}ngOnDestroy(){var e;null===(e=this.cartSub)||void 0===e||e.unsubscribe()}presentLoading(){return(0,m.mG)(this,void 0,void 0,function*(){yield(yield this.loadingController.create({message:"Please wait..."})).present()})}goToCart(){this.router.navigate(["/cart"])}updateCartDetails(){if(0===this.cartService.getCart().length)return this.total_amt=0,this.totalItems=0,void(this.orderSummary=[]);this.total_amt=this.cartService.getTotal(),this.totalItems=this.cartService.getTotalItems(),this.updateOrderSummary()}add(e){const r=this.orders[e];r&&r.qtyLeft>0&&(r.qty++,r.qtyLeft--,this.fireService.addToCart({id:Number(r.prodID),name:r.title,price:r.amount,quantity:1,image:r.image}),this.updateOrderSummary())}remove(e){const r=this.orders[e];r&&r.qty>0&&(r.qty--,r.qtyLeft++,this.fireService.decreaseCartItemQuantity({id:Number(r.prodID),name:r.title,price:r.amount,quantity:1,image:r.image}),this.updateOrderSummary())}updateOrderSummary(){const e=this.fireService.getRawCart();this.orderSummary=e.map(r=>({name:r.name,quantity:r.quantity,price:r.price})),this.total_amt=this.fireService.getTotalPrice(),this.totalItems=this.fireService.getTotalItems()}deleteItem(e){this.orders=this.orders.filter(r=>Number(r.prodID)!==e),this.updateCartDetails()}checkout(){return(0,m.mG)(this,void 0,void 0,function*(){yield(yield this.alertCtrl.create({header:"Thanks for your Order!",message:"Siyeshe Holdings will deliver your Orders as soon as possible",buttons:["OK"]})).present(),this.modalCtrl.dismiss().catch(()=>console.warn("No modal to dismiss")),this.cartService.clearCart()})}goBack(){this.router.navigate(["/home"])}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(o.HT),t.Y36(o.IN),t.Y36(o.Br),t.Y36(t.sBO),t.Y36(g.F0),t.Y36(h.Q),t.Y36(f))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-order"]],decls:39,vars:12,consts:[["color","shade"],["slot","start"],["defaultHref","search-chef","color","dark"],[2,"text-align","center"],["slot","end"],["fill","clear"],["name","notifications-outline"],["color","primary"],["vertical","bottom","horizontal","end","slot","fixed"],[3,"disabled","click"],["name","cart-outline"],["color","success"],[1,"ion-padding"],[4,"ngIf","ngIfElse"],["noOrders",""],[1,"more-items"],[1,"summary-wrapper"],["class","order_summary",4,"ngIf","ngIfElse"],["noItems",""],["color","dark",1,"checkout-toolbar"],[1,"ion-align-items-center"],["size","7"],["color","light"],["size","5",1,"ion-text-right"],["fill","clear","size","small",2,"color","rgb(255, 255, 255)","padding-right","30%","font-weight","bolder",3,"disabled","click"],["slot","end","name","arrow-forward-outline"],["class","order-card",4,"ngFor","ngForOf"],[1,"order-card"],["lines","none"],[3,"src","alt"],[1,"order-info"],[1,"order-id"],[1,"order-amount"],[1,"order-status",3,"ngClass"],[1,"edit-controls"],["fill","outline","size","small",3,"click"],["slot","icon-only","name","remove-outline"],[1,"qty"],["slot","icon-only","name","add-outline"],["fill","clear","color","danger","size","small",3,"click"],["slot","icon-only","name","eye-off"],[1,"item-info"],[1,"empty-state"],["name","cart-outline","size","large"],[1,"order_summary"],[1,"items-list"],["class","order-item",4,"ngFor","ngForOf"],[1,"summary-line"],[1,"order-item"],[1,"order_summary","empty"]],template:function(e,r){if(1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t._UZ(3,"ion-back-button",2),t.qZA(),t.TgZ(4,"ion-title",3),t._uU(5,"Make Orders"),t.qZA(),t.TgZ(6,"ion-buttons",4)(7,"ion-button",5),t._UZ(8,"ion-icon",6),t.TgZ(9,"ion-badge",7),t._uU(10),t.qZA()(),t._UZ(11,"ion-avatar"),t.qZA()()(),t.TgZ(12,"ion-fab",8)(13,"ion-fab-button",9),t.NdJ("click",function(){return r.goToCart()}),t._UZ(14,"ion-icon",10),t.TgZ(15,"ion-badge",11),t._uU(16),t.qZA()()(),t.TgZ(17,"ion-content",12),t.YNc(18,x,2,1,"ion-list",13),t.YNc(19,C,4,0,"ng-template",null,14,t.W1O),t.TgZ(21,"p",15),t._uU(22,"No more items"),t.qZA()(),t.TgZ(23,"ion-footer")(24,"div",16),t.YNc(25,v,22,9,"div",17),t.YNc(26,y,5,0,"ng-template",null,18,t.W1O),t.qZA(),t.TgZ(28,"ion-toolbar",19)(29,"ion-row",20)(30,"ion-col",21)(31,"ion-text",22)(32,"h4"),t._uU(33),t.ALo(34,"number"),t.qZA()()(),t.TgZ(35,"ion-col",23)(36,"ion-button",24),t.NdJ("click",function(){return r.goToCart()}),t._uU(37," cart "),t._UZ(38,"ion-icon",25),t.qZA()()()()()),2&e){const i=t.MAs(20),s=t.MAs(27);t.xp6(10),t.Oqu(r.notifications),t.xp6(3),t.Q6J("disabled",0===r.totalItems),t.xp6(3),t.Oqu(r.totalItems),t.xp6(2),t.Q6J("ngIf",r.orders.length>0)("ngIfElse",i),t.xp6(7),t.Q6J("ngIf",r.orderSummary.length>0)("ngIfElse",s),t.xp6(8),t.hij("Total: R",t.xi3(34,9,r.total_amt,"1.2-2"),""),t.xp6(3),t.Q6J("disabled",0===r.total_amt)}},directives:[o.Gu,o.sr,o.Sm,o.oU,o.cs,o.wd,o.YG,o.gu,o.yp,o.BJ,o.IJ,o.W4,o.W2,d.O5,o.q_,d.sg,o.PM,o.Ie,o.Bs,o.Q$,d.mk,o.FN,o.fr,o.Nd,o.wI,o.yW],pipes:[d.JJ],styles:['[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: #f8f8ff}.empty-state[_ngcontent-%COMP%]{text-align:center;color:#777;margin-top:50%}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#ccc;margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px}.order-card[_ngcontent-%COMP%]{margin:12px 0;--background: #fff;border-radius:8px;box-shadow:0 2px 6px #0000001a}.order-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--inner-padding-end: 0;--inner-padding-start: 0}.order-card[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:6px;overflow:hidden;margin-right:12px}.order-card[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover;width:100%;height:100%}.order-card[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 4px;font-size:16px;color:#333}.order-card[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:2px 0;font-size:14px;color:#555}.order-card[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   .order-status.confirmed[_ngcontent-%COMP%]{color:green;font-weight:700}.order-card[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   .order-status.pending[_ngcontent-%COMP%]{color:orange;font-weight:700}.order-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:8px 16px}.order-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .edit-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:8px}.order-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .edit-controls[_ngcontent-%COMP%]   .qty[_ngcontent-%COMP%]{min-width:24px;text-align:center;font-weight:600;color:#333}.order-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .edit-controls[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--min-width: 32px;--min-height: 32px;--padding: 0}.order-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]{font-size:14px;color:#666}.more-items[_ngcontent-%COMP%]{text-align:center;color:#f15b3a;font-weight:600;margin:20px 0;cursor:pointer}.summary-wrapper[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#f0f0f0,#d1d1d1 70%);max-height:200px;overflow-y:auto;padding:12px;box-shadow:inset 0 0 10px #fff9,0 4px 8px #0000001a;border-radius:25px;border:1px solid rgba(0,0,0,.2);background-blend-mode:overlay;position:relative}.summary-wrapper[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;width:100%;height:100%;border-radius:25px;background:linear-gradient(rgba(255,255,255,.4),rgba(255,255,255,0));pointer-events:none}.items-list[_ngcontent-%COMP%]{max-height:130px;overflow-y:auto;margin-bottom:8px}.order-item[_ngcontent-%COMP%]{padding:6px 0;border-bottom:1px dotted #ccc;color:#333;font-size:14px}.summary-line[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-weight:600;color:#333;padding:4px 0;border-top:1px solid #eee}.order_summary.empty[_ngcontent-%COMP%]{text-align:center;color:#777}.order_summary.empty[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:8px;color:#f15b3a}.checkout-toolbar[_ngcontent-%COMP%]{--padding-top: 6px;--padding-bottom: 6px}']}),n})()}];let Z=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[g.Bz.forChild(P)],g.Bz]}),n})(),M=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[d.ez,p.u5,o.Pc,Z]]}),n})()}}]);