"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4238],{4238:(U,_,c)=>{c.r(_),c.d(_,{OrderPageModule:()=>I});var g=c(9808),m=c(2382),n=c(8161),u=c(5852),d=c(7582),h=c(9839),t=c(5e3);let f=(()=>{class o{constructor(e,r){this.router=e,this.popoverCtrl=r}navigateTo(e){this.popoverCtrl.dismiss(),this.router.navigate([`/${e}`])}logout(){this.popoverCtrl.dismiss(),this.router.navigate(["/login"])}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(u.F0),t.Y36(n.Dh))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-menu-popover"]],decls:17,vars:0,consts:[[1,"glassy-list",2,"font-weight","bold"],[1,"home-item",3,"click"],["slot","start","name","home-outline"],[1,"orders-item",3,"click"],["slot","start","name","receipt-outline"],[1,"settings-item",3,"click"],["slot","start","name","settings-outline"],[1,"logout-item",2,"color","red",3,"click"],["slot","start","name","log-out-outline"]],template:function(e,r){1&e&&(t.TgZ(0,"ion-list",0)(1,"ion-item",1),t.NdJ("click",function(){return r.navigateTo("home")}),t._UZ(2,"ion-icon",2),t.TgZ(3,"ion-label"),t._uU(4,"Home"),t.qZA()(),t.TgZ(5,"ion-item",3),t.NdJ("click",function(){return r.navigateTo("orders")}),t._UZ(6,"ion-icon",4),t.TgZ(7,"ion-label"),t._uU(8,"Orders"),t.qZA()(),t.TgZ(9,"ion-item",5),t.NdJ("click",function(){return r.navigateTo("settings")}),t._UZ(10,"ion-icon",6),t.TgZ(11,"ion-label"),t._uU(12,"Settings"),t.qZA()(),t.TgZ(13,"ion-item",7),t.NdJ("click",function(){return r.logout()}),t._UZ(14,"ion-icon",8),t.TgZ(15,"ion-label"),t._uU(16,"Logout"),t.qZA()()())},directives:[n.q_,n.Ie,n.gu,n.Q$],encapsulation:2}),o})();var C=c(1447),v=c(1135);let O=(()=>{class o{constructor(){this.cart=[],this.cartObservable=new v.X([]),this.loadCart()}loadCart(){const e=localStorage.getItem("cart");e&&(this.cart=JSON.parse(e),this.cartObservable.next(this.cart))}saveCart(){localStorage.setItem("cart",JSON.stringify(this.cart))}getCart(){return this.cart}getCartObservable(){return this.cartObservable.asObservable()}getTotal(){return this.cart.reduce((e,r)=>e+r.price*r.quantity,0)}getTotalItems(){return this.cart.reduce((e,r)=>e+r.quantity,0)}addProduct(e){const r=this.cart.find(i=>i.id===e.id);r?r.quantity+=e.quantity:this.cart.push(e),this.saveCart(),this.cartObservable.next(this.cart)}decreaseProduct(e){const r=this.cart.findIndex(i=>i.id===e.id);r>-1&&(this.cart[r].quantity>1?this.cart[r].quantity--:this.cart.splice(r,1),this.saveCart(),this.cartObservable.next(this.cart))}removeProduct(e){const r=this.cart.findIndex(i=>i.id===e.id);r>-1&&(this.cart.splice(r,1),this.saveCart(),this.cartObservable.next(this.cart))}clearCart(){this.cart=[],this.saveCart(),this.cartObservable.next(this.cart)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function b(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"ion-card",32)(1,"ion-item",33)(2,"ion-thumbnail",34),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).openImage(a.image)}),t._UZ(3,"img",35),t.qZA(),t.TgZ(4,"ion-label",36)(5,"h2"),t._uU(6),t.qZA(),t.TgZ(7,"p",37),t._uU(8),t.qZA(),t.TgZ(9,"p",38),t._uU(10),t.ALo(11,"number"),t.qZA(),t.TgZ(12,"p",39),t._uU(13),t.qZA(),t.TgZ(14,"ion-button",40),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).writeReview(a)}),t._UZ(15,"ion-icon",41),t._uU(16," Write Review "),t.qZA()()(),t.TgZ(17,"ion-card-content")(18,"div",42)(19,"ion-button",43),t.NdJ("click",function(){const a=t.CHM(e).index;return t.oxw(2).remove(a)}),t._UZ(20,"ion-icon",44),t.qZA(),t.TgZ(21,"span",45),t._uU(22),t.qZA(),t.TgZ(23,"ion-button",43),t.NdJ("click",function(){const a=t.CHM(e).index;return t.oxw(2).add(a)}),t._UZ(24,"ion-icon",46),t.qZA(),t.TgZ(25,"ion-button",47),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).deleteItem(a.prodID)}),t._UZ(26,"ion-icon",48),t.qZA()(),t.TgZ(27,"p",49),t._uU(28),t.ALo(29,"number"),t.qZA()()()}if(2&o){const e=s.$implicit;t.xp6(3),t.Q6J("src",e.image,t.LSH)("alt",e.title),t.xp6(3),t.Oqu(e.title),t.xp6(2),t.hij("ID: ",e.prodID,""),t.xp6(2),t.hij("R",t.xi3(11,10,e.amount,"1.2-2"),""),t.xp6(2),t.Q6J("ngClass","CONFIRMED"===e.status?"confirmed":"pending"),t.xp6(1),t.hij(" ",e.status," "),t.xp6(9),t.Oqu(e.qty),t.xp6(6),t.AsE(" Price: R",t.xi3(29,13,e.amount,"1.2-2")," \u2022 Left: ",e.qtyLeft," ")}}function x(o,s){if(1&o&&(t.TgZ(0,"ion-list"),t.YNc(1,b,30,16,"ion-card",31),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.orders)}}function y(o,s){1&o&&(t.TgZ(0,"div",50),t._UZ(1,"ion-icon",51),t.TgZ(2,"p"),t._uU(3,"No orders to display."),t.qZA()())}function P(o,s){if(1&o&&(t.TgZ(0,"div",56),t._uU(1),t.ALo(2,"number"),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.lnq(" ",e.name," \u2014 Qty: ",e.quantity," \u2014 R",t.xi3(2,3,e.price*e.quantity,"1.2-2")," ")}}function Z(o,s){if(1&o&&(t.TgZ(0,"div",52)(1,"h3"),t._uU(2,"Order Summary"),t.qZA(),t.TgZ(3,"div",53),t.YNc(4,P,3,6,"div",54),t.qZA(),t.TgZ(5,"div",55)(6,"span"),t._uU(7,"Sub Total:"),t.qZA(),t.TgZ(8,"span"),t._uU(9),t.ALo(10,"number"),t.qZA()(),t.TgZ(11,"div",55)(12,"span"),t._uU(13,"VAT Included:"),t.qZA(),t.TgZ(14,"span"),t._uU(15),t.ALo(16,"number"),t.qZA()(),t.TgZ(17,"div",55)(18,"span"),t._uU(19,"Delivery:"),t.qZA(),t.TgZ(20,"span"),t._uU(21,"Free"),t.qZA()()()),2&o){const e=t.oxw();t.xp6(4),t.Q6J("ngForOf",e.orderSummary),t.xp6(5),t.hij("R",t.xi3(10,3,e.total_amt,"1.2-2"),""),t.xp6(6),t.hij("R",t.xi3(16,6,15*e.total_amt/115,"1.2-2"),"")}}function T(o,s){1&o&&(t.TgZ(0,"div",57)(1,"h3"),t._uU(2,"Order Summary"),t.qZA(),t.TgZ(3,"p"),t._uU(4,"No items selected."),t.qZA()())}function M(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",58),t.NdJ("click",function(){return t.CHM(e),t.oxw().presentAlert()}),t._UZ(1,"ion-icon",59),t.qZA()}}const q=[{path:"",component:(()=>{class o{constructor(e,r,i,a,l,p,k,w,S){this.loadingController=e,this.modalCtrl=r,this.alertCtrl=i,this.cdr=a,this.router=l,this.fireService=p,this.cartService=k,this.toastCtrl=w,this.popoverCtrl=S,this.searchTerm="",this.allOrders=[],this.orders=[],this.amount=0,this.total_amt=0,this.totalItems=0,this.notifications=0,this.orderSummary=[]}ngOnInit(){this.cartService.clearCart(),this.total_amt=0,this.totalItems=0,this.orderSummary=[],this.presentLoading().then(()=>{this.fireService.getProducts().subscribe(e=>{this.orders=e.map(r=>{var i,a;return Object.assign(Object.assign({},r),{qty:0,qtyLeft:null!==(a=null!==(i=r.qtyLeft)&&void 0!==i?i:r.stock)&&void 0!==a?a:r.qty})}),this.allOrders=[...this.orders],this.loadingController.dismiss(),this.cdr.detectChanges()})}),this.cartSub=this.cartService.getCartObservable().subscribe(()=>{this.totalItems=this.cartService.getTotalItems(),this.total_amt=this.cartService.getTotal(),this.updateOrderSummary(),this.cdr.detectChanges()})}filterOrdersDebounced(){clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>this.filterOrders(),200)}filterOrders(){const e=this.searchTerm.trim().toLowerCase();this.orders=e?this.allOrders.filter(r=>{var i,a;const l=(null===(i=r.title)||void 0===i?void 0:i.toLowerCase())||"",p=(null===(a=r.prodID)||void 0===a?void 0:a.toString())||"";return l.includes(e)||p.includes(e)}):[...this.allOrders]}ngOnDestroy(){var e;null===(e=this.cartSub)||void 0===e||e.unsubscribe()}presentLoading(){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.loadingController.create({message:"Please wait..."})).present()})}goToCart(){this.router.navigate(["/cart"],{queryParams:{from:"orders"}})}updateCartDetails(){if(0===this.cartService.getCart().length)return this.total_amt=0,this.totalItems=0,void(this.orderSummary=[]);this.total_amt=this.cartService.getTotal(),this.totalItems=this.cartService.getTotalItems(),this.updateOrderSummary()}add(e){const r=this.orders[e];r&&r.qtyLeft>0&&(r.qty++,r.qtyLeft--,this.fireService.addToCart({id:Number(r.prodID),name:r.title,price:r.amount,quantity:1,image:r.image}),this.updateOrderSummary())}remove(e){const r=this.orders[e];r&&r.qty>0&&(r.qty--,r.qtyLeft++,this.fireService.decreaseCartItemQuantity({id:Number(r.prodID),name:r.title,price:r.amount,quantity:1,image:r.image}),this.updateOrderSummary())}updateOrderSummary(){const e=this.fireService.getRawCart();this.orderSummary=e.map(r=>({name:r.name,quantity:r.quantity,price:r.price})),this.total_amt=this.fireService.getTotalPrice(),this.totalItems=this.fireService.getTotalItems()}deleteItem(e){this.orders=this.orders.filter(r=>Number(r.prodID)!==e),this.updateCartDetails()}checkout(){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.alertCtrl.create({header:"Thanks for your Order!",message:"Siyeshe Holdings will deliver your Orders as soon as possible",buttons:["OK"]})).present(),this.modalCtrl.dismiss().catch(()=>console.warn("No modal to dismiss")),this.cartService.clearCart()})}clearCart(){this.cartService.clearCart(),this.total_amt=0,this.totalItems=0,this.orderSummary=[],this.orders=this.orders.map(e=>{var r,i;return Object.assign(Object.assign({},e),{qty:0,qtyLeft:null!==(i=null!==(r=e.qtyLeft)&&void 0!==r?r:e.stock)&&void 0!==i?i:e.qty})}),this.cdr.detectChanges()}presentAlert(){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.alertCtrl.create({header:"Clear Cart",message:"Are you sure you want to clear your cart?",animated:!0,cssClass:"alert-custom-style",backdropDismiss:!1,buttons:[{text:"Cancel",role:"cancel",cssClass:"alert-button-cancel",handler:()=>{console.log("Cart remains safe!")}},{text:"Clear",cssClass:"alert-button-delete",handler:()=>{this.clearCart(),this.showToast("Cart cleared successfully \u{1f6d2}")}}]})).present()})}showToast(e){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.toastCtrl.create({message:e,duration:2e3,position:"bottom",color:"danger",icon:"trash-outline"})).present()})}goBack(){this.router.navigate(["/home"])}openImage(e){return(0,d.mG)(this,void 0,void 0,function*(){return yield(yield this.modalCtrl.create({component:h.t,componentProps:{imageSrc:e},cssClass:"image-preview-modal"})).present()})}presentPopover(e){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.popoverCtrl.create({component:f,event:e,translucent:!0,showBackdrop:!1})).present()})}writeReview(e){console.log("Item being reviewed:",e);const r={prodID:e.prodID.toString(),title:e.title,price:e.amount,image:e.image||"assets/default-product.png"};console.log("Passing product data to review:",r),this.router.navigate(["/reviews"],{state:{product:r}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(n.HT),t.Y36(n.IN),t.Y36(n.Br),t.Y36(t.sBO),t.Y36(u.F0),t.Y36(C.Q),t.Y36(O),t.Y36(n.yF),t.Y36(n.Dh))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-order"]],decls:43,vars:14,consts:[["color","shade"],["slot","start"],["defaultHref","search-chef","color","dark"],[2,"text-align","center"],["slot","end"],["fill","clear"],["name","notifications-outline"],["color","primary"],[3,"click"],["src","https://i.imgur.com/Hu1uryf.png"],["vertical","bottom","horizontal","end","slot","fixed"],[3,"disabled","click"],["name","cart-outline"],["color","success"],["placeholder","Search by product name or ID",3,"ngModel","ngModelChange"],[1,"ion-padding"],[4,"ngIf","ngIfElse"],["noOrders",""],[1,"more-items"],[1,"summary-wrapper"],["class","order_summary",4,"ngIf","ngIfElse"],["noItems",""],["color","dark",1,"checkout-toolbar"],[1,"ion-align-items-center"],["size","6"],["color","light"],["size","1",1,"ion-text-center"],["fill","clear","size","small","color","danger","style","font-size: 18px",3,"click",4,"ngIf"],["size","5",1,"ion-text-right"],["fill","clear","size","small",2,"color","#fff","font-weight","bolder",3,"disabled","click"],["slot","end","name","arrow-forward-outline"],["class","order-card",4,"ngFor","ngForOf"],[1,"order-card"],["lines","none"],["slot","start",3,"click"],[3,"src","alt"],[1,"order-info"],[1,"order-id"],[1,"order-amount"],[1,"order-status",3,"ngClass"],["fill","clear","size","small",2,"background-color","rgba(250, 250, 138, 0.288)",3,"click"],["name","star-outline","slot","start"],[1,"edit-controls"],["fill","outline","size","small",3,"click"],["slot","icon-only","name","remove-outline"],[1,"qty"],["slot","icon-only","name","add-outline"],["fill","clear","color","danger","size","small",3,"click"],["slot","icon-only","name","eye-off"],[1,"item-info"],[1,"empty-state"],["name","cart-outline","size","large"],[1,"order_summary"],[1,"items-list"],["class","order-item",4,"ngFor","ngForOf"],[1,"summary-line"],[1,"order-item"],[1,"order_summary","empty"],["fill","clear","size","small","color","danger",2,"font-size","18px",3,"click"],["name","close-circle","slot","icon-only"]],template:function(e,r){if(1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t._UZ(3,"ion-back-button",2),t.qZA(),t.TgZ(4,"ion-title",3),t._uU(5,"Make Orders"),t.qZA(),t.TgZ(6,"ion-buttons",4)(7,"ion-button",5),t._UZ(8,"ion-icon",6),t.TgZ(9,"ion-badge",7),t._uU(10),t.qZA()(),t.TgZ(11,"ion-avatar",8),t.NdJ("click",function(a){return r.presentPopover(a)}),t._UZ(12,"img",9),t.qZA()()()(),t.TgZ(13,"ion-fab",10)(14,"ion-fab-button",11),t.NdJ("click",function(){return r.goToCart()}),t._UZ(15,"ion-icon",12),t.TgZ(16,"ion-badge",13),t._uU(17),t.qZA()()(),t.TgZ(18,"ion-searchbar",14),t.NdJ("ngModelChange",function(a){return r.searchTerm=a})("ngModelChange",function(){return r.filterOrdersDebounced()}),t.qZA(),t.TgZ(19,"ion-content",15),t.YNc(20,x,2,1,"ion-list",16),t.YNc(21,y,4,0,"ng-template",null,17,t.W1O),t.TgZ(23,"p",18),t._uU(24,"No more items"),t.qZA()(),t.TgZ(25,"ion-footer")(26,"div",19),t.YNc(27,Z,22,9,"div",20),t.YNc(28,T,5,0,"ng-template",null,21,t.W1O),t.qZA(),t.TgZ(30,"ion-toolbar",22)(31,"ion-row",23)(32,"ion-col",24)(33,"ion-text",25)(34,"h4"),t._uU(35),t.ALo(36,"number"),t.qZA()()(),t.TgZ(37,"ion-col",26),t.YNc(38,M,2,0,"ion-button",27),t.qZA(),t.TgZ(39,"ion-col",28)(40,"ion-button",29),t.NdJ("click",function(){return r.goToCart()}),t._uU(41," cart------ "),t._UZ(42,"ion-icon",30),t.qZA()()()()()),2&e){const i=t.MAs(22),a=t.MAs(29);t.xp6(10),t.Oqu(r.notifications),t.xp6(4),t.Q6J("disabled",0===r.totalItems),t.xp6(3),t.Oqu(r.totalItems),t.xp6(1),t.Q6J("ngModel",r.searchTerm),t.xp6(2),t.Q6J("ngIf",r.orders.length>0)("ngIfElse",i),t.xp6(7),t.Q6J("ngIf",r.orderSummary.length>0)("ngIfElse",a),t.xp6(8),t.hij("Total: R",t.xi3(36,11,r.total_amt,"1.2-2"),""),t.xp6(3),t.Q6J("ngIf",r.total_amt>0),t.xp6(2),t.Q6J("disabled",0===r.total_amt)}},directives:[n.Gu,n.sr,n.Sm,n.oU,n.cs,n.wd,n.YG,n.gu,n.yp,n.BJ,n.IJ,n.W4,n.VI,n.j9,m.JJ,m.On,n.W2,g.O5,n.q_,g.sg,n.PM,n.Ie,n.Bs,n.Q$,g.mk,n.FN,n.fr,n.Nd,n.wI,n.yW],pipes:[g.JJ],styles:['[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: #f8f8ff}.empty-state[_ngcontent-%COMP%]{text-align:center;color:#777;margin-top:50%}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#ccc;margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px}.order-card[_ngcontent-%COMP%]{margin:12px 0;--background: #fff;border-radius:8px;box-shadow:0 2px 6px #0000001a}.order-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--inner-padding-end: 0;--inner-padding-start: 0}.order-card[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:6px;overflow:hidden;margin-right:12px}.order-card[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover;width:100%;height:100%}.order-card[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 4px;font-size:16px;color:#333}.order-card[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:2px 0;font-size:14px;color:#555}.order-card[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   .order-status.confirmed[_ngcontent-%COMP%]{color:green;font-weight:700}.order-card[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   .order-status.pending[_ngcontent-%COMP%]{color:orange;font-weight:700}.order-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:8px 16px}.order-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .edit-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:8px}.order-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .edit-controls[_ngcontent-%COMP%]   .qty[_ngcontent-%COMP%]{min-width:24px;text-align:center;font-weight:600;color:#333}.order-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .edit-controls[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--min-width: 32px;--min-height: 32px;--padding: 0}.order-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]{font-size:14px;color:#666}.more-items[_ngcontent-%COMP%]{text-align:center;color:#f15b3a;font-weight:600;margin:20px 0;cursor:pointer}.summary-wrapper[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#f0f0f0,#d1d1d1 70%);max-height:200px;overflow-y:auto;padding:12px;box-shadow:inset 0 0 10px #fff9,0 4px 8px #0000001a;border-radius:25px;border:1px solid rgba(0,0,0,.2);background-blend-mode:overlay;position:relative}.summary-wrapper[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;width:100%;height:100%;border-radius:25px;background:linear-gradient(rgba(255,255,255,.4),rgba(255,255,255,0));pointer-events:none}.items-list[_ngcontent-%COMP%]{max-height:130px;overflow-y:auto;margin-bottom:8px}.order-item[_ngcontent-%COMP%]{padding:6px 0;border-bottom:1px dotted #ccc;color:#333;font-size:14px}.summary-line[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-weight:600;color:#333;padding:4px 0;border-top:1px solid #eee}.order_summary.empty[_ngcontent-%COMP%]{text-align:center;color:#777}.order_summary.empty[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:8px;color:#f15b3a}.checkout-toolbar[_ngcontent-%COMP%]{--padding-top: 6px;--padding-bottom: 6px}']}),o})()}];let A=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[u.Bz.forChild(q)],u.Bz]}),o})(),I=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[g.ez,m.u5,n.Pc,A]]}),o})()}}]);