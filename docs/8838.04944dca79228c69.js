"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8838],{8838:(I,m,c)=>{c.r(m),c.d(m,{OrderPageModule:()=>M});var l=c(9808),p=c(2382),o=c(8161),u=c(6115),d=c(655),t=c(5e3),h=c(6131),_=c(1135);let f=(()=>{class n{constructor(){this.cart=[],this.cartObservable=new _.X([]),this.loadCart()}loadCart(){const e=localStorage.getItem("cart");e&&(this.cart=JSON.parse(e),this.cartObservable.next(this.cart))}saveCart(){localStorage.setItem("cart",JSON.stringify(this.cart))}getCart(){return this.cart}getCartObservable(){return this.cartObservable.asObservable()}getTotal(){return this.cart.reduce((e,r)=>e+r.price*r.quantity,0)}getTotalItems(){return this.cart.reduce((e,r)=>e+r.quantity,0)}addProduct(e){const r=this.cart.find(i=>i.id===e.id);r?r.quantity+=e.quantity:this.cart.push(e),this.saveCart(),this.cartObservable.next(this.cart)}decreaseProduct(e){const r=this.cart.findIndex(i=>i.id===e.id);r>-1&&(this.cart[r].quantity>1?this.cart[r].quantity--:this.cart.splice(r,1),this.saveCart(),this.cartObservable.next(this.cart))}removeProduct(e){const r=this.cart.findIndex(i=>i.id===e.id);r>-1&&(this.cart.splice(r,1),this.saveCart(),this.cartObservable.next(this.cart))}clearCart(){this.cart=[],this.saveCart(),this.cartObservable.next(this.cart)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function C(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"ion-card",30)(1,"ion-item",31)(2,"ion-thumbnail",1),t._UZ(3,"img",32),t.qZA(),t.TgZ(4,"ion-label",33)(5,"h2"),t._uU(6),t.qZA(),t.TgZ(7,"p",34),t._uU(8),t.qZA(),t.TgZ(9,"p",35),t._uU(10),t.ALo(11,"number"),t.qZA(),t.TgZ(12,"p",36),t._uU(13),t.qZA()()(),t.TgZ(14,"ion-card-content")(15,"div",37)(16,"ion-button",38),t.NdJ("click",function(){const s=t.CHM(e).index;return t.oxw(2).remove(s)}),t._UZ(17,"ion-icon",39),t.qZA(),t.TgZ(18,"span",40),t._uU(19),t.qZA(),t.TgZ(20,"ion-button",38),t.NdJ("click",function(){const s=t.CHM(e).index;return t.oxw(2).add(s)}),t._UZ(21,"ion-icon",41),t.qZA(),t.TgZ(22,"ion-button",42),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).deleteItem(s.prodID)}),t._UZ(23,"ion-icon",43),t.qZA()(),t.TgZ(24,"p",44),t._uU(25),t.ALo(26,"number"),t.qZA()()()}if(2&n){const e=a.$implicit;t.xp6(3),t.s9C("alt",e.title),t.Q6J("src",e.image,t.LSH),t.xp6(3),t.Oqu(e.title),t.xp6(2),t.hij("ID: ",e.prodID,""),t.xp6(2),t.hij("R",t.xi3(11,10,e.amount,"1.2-2"),""),t.xp6(2),t.Q6J("ngClass","CONFIRMED"===e.status?"confirmed":"pending"),t.xp6(1),t.hij(" ",e.status," "),t.xp6(6),t.Oqu(e.qty),t.xp6(6),t.AsE(" Price: R",t.xi3(26,13,e.amount,"1.2-2")," \u2022 Left: ",e.qtyLeft," ")}}function O(n,a){if(1&n&&(t.TgZ(0,"ion-list"),t.YNc(1,C,27,16,"ion-card",29),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.orders)}}function x(n,a){1&n&&(t.TgZ(0,"div",45),t._UZ(1,"ion-icon",46),t.TgZ(2,"p"),t._uU(3,"No orders to display."),t.qZA()())}function b(n,a){if(1&n&&(t.TgZ(0,"div",51),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.lnq(" ",e.name," \u2014 Qty: ",e.quantity," \u2014 R",t.xi3(2,3,e.price*e.quantity,"1.2-2")," ")}}function y(n,a){if(1&n&&(t.TgZ(0,"div",47)(1,"h3"),t._uU(2,"Order Summary"),t.qZA(),t.TgZ(3,"div",48),t.YNc(4,b,3,6,"div",49),t.qZA(),t.TgZ(5,"div",50)(6,"span"),t._uU(7,"Sub Total:"),t.qZA(),t.TgZ(8,"span"),t._uU(9),t.ALo(10,"number"),t.qZA()(),t.TgZ(11,"div",50)(12,"span"),t._uU(13,"VAT Included:"),t.qZA(),t.TgZ(14,"span"),t._uU(15),t.ALo(16,"number"),t.qZA()(),t.TgZ(17,"div",50)(18,"span"),t._uU(19,"Delivery:"),t.qZA(),t.TgZ(20,"span"),t._uU(21,"Free"),t.qZA()()()),2&n){const e=t.oxw();t.xp6(4),t.Q6J("ngForOf",e.orderSummary),t.xp6(5),t.hij("R",t.xi3(10,3,e.total_amt,"1.2-2"),""),t.xp6(6),t.hij("R",t.xi3(16,6,15*e.total_amt/115,"1.2-2"),"")}}function v(n,a){1&n&&(t.TgZ(0,"div",52)(1,"h3"),t._uU(2,"Order Summary"),t.qZA(),t.TgZ(3,"p"),t._uU(4,"No items selected."),t.qZA()())}function P(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"ion-button",53),t.NdJ("click",function(){return t.CHM(e),t.oxw().presentAlert()}),t._UZ(1,"ion-icon",54),t.qZA()}}const Z=[{path:"",component:(()=>{class n{constructor(e,r,i,s,g,q,A,S){this.loadingController=e,this.modalCtrl=r,this.alertCtrl=i,this.cdr=s,this.router=g,this.fireService=q,this.cartService=A,this.toastCtrl=S,this.amount=0,this.orders=[],this.total_amt=0,this.totalItems=0,this.notifications=0,this.orderSummary=[]}ngOnInit(){this.cartService.clearCart(),this.total_amt=0,this.totalItems=0,this.orderSummary=[],this.presentLoading().then(()=>{this.fireService.getProducts().subscribe(e=>{this.orders=e.map(r=>{var i,s;return Object.assign(Object.assign({},r),{qty:0,qtyLeft:null!==(s=null!==(i=r.qtyLeft)&&void 0!==i?i:r.stock)&&void 0!==s?s:r.qty})}),this.loadingController.dismiss(),this.cdr.detectChanges()})}),this.cartSub=this.cartService.getCartObservable().subscribe(()=>{this.totalItems=this.cartService.getTotalItems(),this.total_amt=this.cartService.getTotal(),this.updateOrderSummary(),this.cdr.detectChanges()})}ngOnDestroy(){var e;null===(e=this.cartSub)||void 0===e||e.unsubscribe()}presentLoading(){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.loadingController.create({message:"Please wait..."})).present()})}goToCart(){this.router.navigate(["/cart"],{queryParams:{from:"orders"}})}updateCartDetails(){if(0===this.cartService.getCart().length)return this.total_amt=0,this.totalItems=0,void(this.orderSummary=[]);this.total_amt=this.cartService.getTotal(),this.totalItems=this.cartService.getTotalItems(),this.updateOrderSummary()}add(e){const r=this.orders[e];r&&r.qtyLeft>0&&(r.qty++,r.qtyLeft--,this.fireService.addToCart({id:Number(r.prodID),name:r.title,price:r.amount,quantity:1,image:r.image}),this.updateOrderSummary())}remove(e){const r=this.orders[e];r&&r.qty>0&&(r.qty--,r.qtyLeft++,this.fireService.decreaseCartItemQuantity({id:Number(r.prodID),name:r.title,price:r.amount,quantity:1,image:r.image}),this.updateOrderSummary())}updateOrderSummary(){const e=this.fireService.getRawCart();this.orderSummary=e.map(r=>({name:r.name,quantity:r.quantity,price:r.price})),this.total_amt=this.fireService.getTotalPrice(),this.totalItems=this.fireService.getTotalItems()}deleteItem(e){this.orders=this.orders.filter(r=>Number(r.prodID)!==e),this.updateCartDetails()}checkout(){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.alertCtrl.create({header:"Thanks for your Order!",message:"Siyeshe Holdings will deliver your Orders as soon as possible",buttons:["OK"]})).present(),this.modalCtrl.dismiss().catch(()=>console.warn("No modal to dismiss")),this.cartService.clearCart()})}clearCart(){this.cartService.clearCart(),this.total_amt=0,this.totalItems=0,this.orderSummary=[],this.orders=this.orders.map(e=>{var r,i;return Object.assign(Object.assign({},e),{qty:0,qtyLeft:null!==(i=null!==(r=e.qtyLeft)&&void 0!==r?r:e.stock)&&void 0!==i?i:e.qty})}),this.cdr.detectChanges()}presentAlert(){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.alertCtrl.create({header:"Clear Cart",message:"Are you sure you want to clear your cart?",animated:!0,cssClass:"alert-custom-style",backdropDismiss:!1,buttons:[{text:"Cancel",role:"cancel",cssClass:"alert-button-cancel",handler:()=>{console.log("Cart remains safe!")}},{text:"Clear",cssClass:"alert-button-delete",handler:()=>{this.clearCart(),this.showToast("Cart cleared successfully \u{1f6d2}")}}]})).present()})}showToast(e){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.toastCtrl.create({message:e,duration:2e3,position:"bottom",color:"danger",icon:"trash-outline"})).present()})}goBack(){this.router.navigate(["/home"])}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(o.HT),t.Y36(o.IN),t.Y36(o.Br),t.Y36(t.sBO),t.Y36(u.F0),t.Y36(h.Q),t.Y36(f),t.Y36(o.yF))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-order"]],decls:42,vars:13,consts:[["color","shade"],["slot","start"],["defaultHref","search-chef","color","dark"],[2,"text-align","center"],["slot","end"],["fill","clear"],["name","notifications-outline"],["color","primary"],["src","https://i.imgur.com/Hu1uryf.png"],["vertical","bottom","horizontal","end","slot","fixed"],[3,"disabled","click"],["name","cart-outline"],["color","success"],[1,"ion-padding"],[4,"ngIf","ngIfElse"],["noOrders",""],[1,"more-items"],[1,"summary-wrapper"],["class","order_summary",4,"ngIf","ngIfElse"],["noItems",""],["color","dark",1,"checkout-toolbar"],[1,"ion-align-items-center"],["size","6"],["color","light"],["size","1",1,"ion-text-center"],["fill","clear","size","small","color","danger","style","font-size: 18px",3,"click",4,"ngIf"],["size","5",1,"ion-text-right"],["fill","clear","size","small",2,"color","#fff","font-weight","bolder",3,"disabled","click"],["slot","end","name","arrow-forward-outline"],["class","order-card",4,"ngFor","ngForOf"],[1,"order-card"],["lines","none"],[3,"src","alt"],[1,"order-info"],[1,"order-id"],[1,"order-amount"],[1,"order-status",3,"ngClass"],[1,"edit-controls"],["fill","outline","size","small",3,"click"],["slot","icon-only","name","remove-outline"],[1,"qty"],["slot","icon-only","name","add-outline"],["fill","clear","color","danger","size","small",3,"click"],["slot","icon-only","name","eye-off"],[1,"item-info"],[1,"empty-state"],["name","cart-outline","size","large"],[1,"order_summary"],[1,"items-list"],["class","order-item",4,"ngFor","ngForOf"],[1,"summary-line"],[1,"order-item"],[1,"order_summary","empty"],["fill","clear","size","small","color","danger",2,"font-size","18px",3,"click"],["name","close-circle","slot","icon-only"]],template:function(e,r){if(1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t._UZ(3,"ion-back-button",2),t.qZA(),t.TgZ(4,"ion-title",3),t._uU(5,"Make Orders"),t.qZA(),t.TgZ(6,"ion-buttons",4)(7,"ion-button",5),t._UZ(8,"ion-icon",6),t.TgZ(9,"ion-badge",7),t._uU(10),t.qZA()(),t.TgZ(11,"ion-avatar"),t._UZ(12,"img",8),t.qZA()()()(),t.TgZ(13,"ion-fab",9)(14,"ion-fab-button",10),t.NdJ("click",function(){return r.goToCart()}),t._UZ(15,"ion-icon",11),t.TgZ(16,"ion-badge",12),t._uU(17),t.qZA()()(),t.TgZ(18,"ion-content",13),t.YNc(19,O,2,1,"ion-list",14),t.YNc(20,x,4,0,"ng-template",null,15,t.W1O),t.TgZ(22,"p",16),t._uU(23,"No more items"),t.qZA()(),t.TgZ(24,"ion-footer")(25,"div",17),t.YNc(26,y,22,9,"div",18),t.YNc(27,v,5,0,"ng-template",null,19,t.W1O),t.qZA(),t.TgZ(29,"ion-toolbar",20)(30,"ion-row",21)(31,"ion-col",22)(32,"ion-text",23)(33,"h4"),t._uU(34),t.ALo(35,"number"),t.qZA()()(),t.TgZ(36,"ion-col",24),t.YNc(37,P,2,0,"ion-button",25),t.qZA(),t.TgZ(38,"ion-col",26)(39,"ion-button",27),t.NdJ("click",function(){return r.goToCart()}),t._uU(40," cart------ "),t._UZ(41,"ion-icon",28),t.qZA()()()()()),2&e){const i=t.MAs(21),s=t.MAs(28);t.xp6(10),t.Oqu(r.notifications),t.xp6(4),t.Q6J("disabled",0===r.totalItems),t.xp6(3),t.Oqu(r.totalItems),t.xp6(2),t.Q6J("ngIf",r.orders.length>0)("ngIfElse",i),t.xp6(7),t.Q6J("ngIf",r.orderSummary.length>0)("ngIfElse",s),t.xp6(8),t.hij("Total: R",t.xi3(35,10,r.total_amt,"1.2-2"),""),t.xp6(3),t.Q6J("ngIf",r.total_amt>0),t.xp6(2),t.Q6J("disabled",0===r.total_amt)}},directives:[o.Gu,o.sr,o.Sm,o.oU,o.cs,o.wd,o.YG,o.gu,o.yp,o.BJ,o.IJ,o.W4,o.W2,l.O5,o.q_,l.sg,o.PM,o.Ie,o.Bs,o.Q$,l.mk,o.FN,o.fr,o.Nd,o.wI,o.yW],pipes:[l.JJ],styles:['[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: #f8f8ff}.empty-state[_ngcontent-%COMP%]{text-align:center;color:#777;margin-top:50%}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#ccc;margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px}.order-card[_ngcontent-%COMP%]{margin:12px 0;--background: #fff;border-radius:8px;box-shadow:0 2px 6px #0000001a}.order-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--inner-padding-end: 0;--inner-padding-start: 0}.order-card[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:6px;overflow:hidden;margin-right:12px}.order-card[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover;width:100%;height:100%}.order-card[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 4px;font-size:16px;color:#333}.order-card[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:2px 0;font-size:14px;color:#555}.order-card[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   .order-status.confirmed[_ngcontent-%COMP%]{color:green;font-weight:700}.order-card[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   .order-status.pending[_ngcontent-%COMP%]{color:orange;font-weight:700}.order-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:8px 16px}.order-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .edit-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:8px}.order-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .edit-controls[_ngcontent-%COMP%]   .qty[_ngcontent-%COMP%]{min-width:24px;text-align:center;font-weight:600;color:#333}.order-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .edit-controls[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--min-width: 32px;--min-height: 32px;--padding: 0}.order-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]{font-size:14px;color:#666}.more-items[_ngcontent-%COMP%]{text-align:center;color:#f15b3a;font-weight:600;margin:20px 0;cursor:pointer}.summary-wrapper[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#f0f0f0,#d1d1d1 70%);max-height:200px;overflow-y:auto;padding:12px;box-shadow:inset 0 0 10px #fff9,0 4px 8px #0000001a;border-radius:25px;border:1px solid rgba(0,0,0,.2);background-blend-mode:overlay;position:relative}.summary-wrapper[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;width:100%;height:100%;border-radius:25px;background:linear-gradient(rgba(255,255,255,.4),rgba(255,255,255,0));pointer-events:none}.items-list[_ngcontent-%COMP%]{max-height:130px;overflow-y:auto;margin-bottom:8px}.order-item[_ngcontent-%COMP%]{padding:6px 0;border-bottom:1px dotted #ccc;color:#333;font-size:14px}.summary-line[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-weight:600;color:#333;padding:4px 0;border-top:1px solid #eee}.order_summary.empty[_ngcontent-%COMP%]{text-align:center;color:#777}.order_summary.empty[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:8px;color:#f15b3a}.checkout-toolbar[_ngcontent-%COMP%]{--padding-top: 6px;--padding-bottom: 6px}']}),n})()}];let T=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[u.Bz.forChild(Z)],u.Bz]}),n})(),M=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[l.ez,p.u5,o.Pc,T]]}),n})()}}]);